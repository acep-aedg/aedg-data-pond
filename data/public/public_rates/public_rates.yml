resource:
  name: "public_rates"
  title: "Electricity Rates for Communities"
  summary: |
    This dataset is sales by communities as they are recorded by reporting entities (i.e. utilities).
  description: |
    This dataset is sales by communities as they are recorded by reporting entities (i.e. utilities). There is no single state or federal agency that collects data on all utility sales in Alaska.
    This dataset derives from the Alaska Energy Statistics workbooks, which in turn compiles data from multiple sources including community Power Cost Equalization reports collated by the Alaska Energy Authority and reporting to the U.S. Energy Information Administration (EIA). Source data was harmonized to account for differences in reporting through a combination of subject matter expertise and transformations.
    To address the second issue, ... The same values for sales are reported for all the communities served by the reporting entity [even for AVEC?], which creates multiple duplicate values in this dataset.
  path: "https://raw.githubusercontent.com/acep-aedg/aedg-data-pond/refs/heads/main/data/public/public_rates.csv"
  keywords:
    - sales
    - electricity
    - report
    - Power Cost Equalization (PCE)
    - EIA Form 923
    - community
  topics:
    - Electricity
  publisher: acep
  sources:
    - dcra.communities
    - dol.places
    - acep.es_annual_sales
  licenses:
    - CC-BY-4.0
  spatial:
    name: Alaska
    boundingBox: [-187.55, 51.21, -130.0, 71.35]
    crs: OGC:CRS84
  temporal:
    referenceDate: "2024-02-29"  # equivalent to as_of_date
    timeseries:
      - start: "2021"
        end: "2021"
        resolutionValue: null
        resolutionUnit: year
        alignment: centre
        aggregationType: average
  primaryKey: # An array of fields that uniquely identifies each row in the table
    - fips_code  # this will change to reporting entity when that column gets added
    - year
  contributors: # roles from https://datacite-metadata-schema.readthedocs.io/en/4.5/properties/contributor/#a-contributortype
    - title: Neil McMahon
      organization: acep
      roles:
        - DataCollector
      date: 2024
      object: data from the Alaska Energy Statistics Financial Tables
      comment: |
        Pulled data from the original sources, the compiled, corrected, harmonized, transformed data into Excel Workbooks as annual datasets and as Financial and Generation timeseries. Additional corrections were applied to the yearly data.
    - organization: acep
      roles:
        - DataCurator
      date: now
      object: data via https://github.com/acep-aedg/aedg-etl-2024
      comment: |
        1. Contracted Neil McMahon to produce the Workbooks, and then posted them in GitHub for distribution.
        2. Complied community names, locations, and FIPS identifiers for AEDG
        3. residential rates are pre-calculated as residential_rate for all reporting entities and post-subsidy effective_rate for PCE reporting entities
        4. data for commercial and industrial was reported only as sales and revenue. For these categories, rates were calculated by dividing revenue/sales_mwh, producing the columns industrial_rate_calculated and commercial_rate_calculated.
        5. For good measure, residential rates were also calculated this way. residential_rate pre-calculated in the Workbooks, should equal residential_rate_calculated, calculated by us. (spoiler: they are equal when rounded to 2 decimals, which I codified in a DBT data test)
        6. For a few non-PCE reporting entities, especially Railbelt utilities, neither residential rates nor effective rates were calculated. For this reason, I experimented with combining rates into a single column: starting with effective_rate and filling with residential_rate_calculated when effective_rate was NULL. I’m not sure this is the best approach since they are different situations (non-PCE vs PCE), I suppose that’s worth discussing. We could leave the two columns side by side in order to maintain clarity. Rails would need a smart query to pull calculated_rate when effective_rate was NULL, essentially making that column on the fly. For now, I left all 4 columns so we can look at this in detail.
        7. Joined sales data with AEDG communities to create this dataset
